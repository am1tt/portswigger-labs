## ðŸ§ª Lab: High-Level Logic Vulnerability  
**Level**: Apprentice  
**Date**: June 25, 2025  
**Goal**: Manipulate business logic to bypass credit limitations and purchase an expensive item.

---

### ðŸ§° Tools  
- Burp Suite (Proxy, Repeater)  
- Manual logic flow testing  
- Parameter manipulation

---

### ðŸ§­ Steps

1. Begin with full request flow inspection using **Burp Proxy History**.
2. Locate the item referenced in the lab description and attempt to add it to the cart.
3. The cart request:  
`POST /cart`
quantity=1

is vulnerable â€” try changing `quantity` to negative or exaggerated values.
4. Attempt to reduce the total price by altering `quantity=-14`, but ensure it works **within your 100 credits limit**.
5. If the primary item is too expensive, **add a second, cheaper item to the cart**.
6. Send the cheaper item's request to **Repeater**, modify the quantity to a large negative number.
7. This will lower the **total cart value below 100**, making the expensive item purchasable.
8. Proceed to checkout. âœ…

---

### ðŸ’£ Payload
```
quantity=-14
```
---

### ðŸ’¡ Observations

- âœ… Fixed yesterdayâ€™s mistake by actively checking **entire request flows**.
- Thought 90% of the solution through â€” just needed a small creative leap (add another item).
- Learned how **manipulating one item's quantity** can affect the total cart logic.
- Showed why **taking time to analyze all parameters** is crucial.
- Shows how **business logic flaws** can stem from trusting user-controlled values.

---

### ðŸ”’ Remediation

- Never trust client-side parameters like `quantity` â€” validate strictly on the server.
- Ensure total cart calculations are made **server-side** based on verified product data.
- Prevent negative values in logic â€” use whitelist validation.
- Include back-end logic to enforce purchase limits and item pricing.
- Sanitize all parameters used in arithmetic or conditional logic flows.
